<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CyberSIEM â€” Settings</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-light">
  <div class="d-flex" id="wrapper">

    <!-- Sidebar -->
    <nav id="sidebar" class="bg-white border-end">
      <div class="sidebar-header text-center py-4">
        <img src="assets/logo.png" alt="logo" style="width:48px">
        <h6 class="mt-2">CyberSIEM</h6>
      </div>
      <ul class="list-unstyled ps-0">
        <li class="mb-1"><a href="index.html" class="btn btn-toggle align-items-center rounded"><i class="fa fa-home me-2"></i> Overview</a></li>
        <li class="mb-1"><a href="hosts.html" class="btn btn-toggle align-items-center rounded"><i class="fa fa-server me-2"></i> Hosts</a></li>
        <li class="mb-1"><a href="alerts.html" class="btn btn-toggle align-items-center rounded"><i class="fa fa-bell me-2"></i> Alerts</a></li>
        <li class="mb-1"><a href="settings.html" class="btn btn-toggle align-items-center rounded active"><i class="fa fa-cog me-2"></i> Settings</a></li>
      </ul>
    </nav>

    <!-- Page content -->
    <div id="page-content" class="flex-fill">
      <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
        <div class="container-fluid d-flex align-items-center">
  <button class="btn btn-outline-secondary me-3" id="sidebarToggle">
    <i class="fa fa-bars"></i>
  </button>
  <span class="navbar-brand">Settings</span>

          <div class="d-flex">
            <div class="me-3">Signed in as <strong>You</strong></div>
            <button class="btn btn-outline-secondary btn-sm"><a href="settings.html" style="text-decoration: none;color: inherit">Profile</a></button>
          </div>
        </div>
      </nav>

      <main class="container-fluid p-4">

        <!-- Settings title card -->
        <div class="card shadow-sm p-3 mb-4">
          <h6 class="mb-0">System Settings</h6>
          <small class="text-muted">Configure your dashboard preferences</small>
        </div>

        <!-- Settings sections -->
        <div class="row g-3">

          <!-- Profile Settings -->
          <div class="col-md-6">
            <div class="card shadow-sm p-3">
              <h6><i class="fa fa-user me-2"></i>Profile</h6>
              <hr>
              <div class="mb-3">
                <label class="form-label">Display Name</label>
                <input class="form-control" id="displayName" placeholder="Your name">
              </div>
              <div class="mb-3">
                <label class="form-label">Email Address</label>
                <input class="form-control" id="email" placeholder="you@example.com">
              </div>
              <div class="mb-3">
                <label class="form-label">Role</label>
                <select class="form-select" id="role">
                  <option>Administrator</option>
                  <option>Analyst</option>
                  <option>Viewer</option>
                </select>
              </div>
            </div>
          </div>

          <!-- System Config -->
          <div class="col-md-6">
            <div class="card shadow-sm p-3">
              <h6><i class="fa fa-sliders-h me-2"></i>System Configuration</h6>
              <hr>

              <label class="form-label">Theme</label>
              <select class="form-select mb-3" id="themeMode">
                <option value="light">Light Mode</option>
                <option value="dark">Dark Mode</option>
              </select>

              <label class="form-label">Refresh Interval (seconds)</label>
              <input type="number" class="form-control mb-3" id="refreshInterval" value="30">

              <label class="form-label">Notification Level</label>
              <select class="form-select mb-3" id="notifyLevel">
                <option value="all">All Alerts</option>
                <option value="high">High Only</option>
                <option value="none">Disabled</option>
              </select>
            </div>
          </div>

          <!-- Log Ingestion Settings -->
          <div class="col-12">
            <div class="card shadow-sm p-3">
              <h6><i class="fa fa-file-alt me-2"></i>Log Ingestion</h6>
              <hr>

              <div class="form-check form-switch mb-2">
                <input class="form-check-input" type="checkbox" id="enableLinuxLogs">
                <label class="form-check-label" for="enableLinuxLogs">Enable Linux Auth Logs</label>
              </div>

              <div class="form-check form-switch mb-2">
                <input class="form-check-input" type="checkbox" id="enableWindowsLogs">
                <label class="form-check-label" for="enableWindowsLogs">Enable Windows Event Logs</label>
              </div>

              <div class="form-check form-switch mb-2">
                <input class="form-check-input" type="checkbox" id="enableSysmon">
                <label class="form-check-label" for="enableSysmon">Enable Sysmon Logs</label>
              </div>

              <div class="form-check form-switch mb-2">
                <input class="form-check-input" type="checkbox" id="enableSuricata">
                <label class="form-check-label" for="enableSuricata">Enable Suricata IDS</label>
              </div>
            </div>
          </div>

        </div>

        <!-- Save Button -->
        <div class="mt-4">
          <button class="btn btn-primary px-4" id="saveSettings">
            <i class="fa fa-save me-2"></i>Save Changes
          </button>
        </div>

      </main>
    </div>
  </div>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Optional common mock-data -->
  <script src="js/mock-data.js"></script>

  <script>
  // fallback mock settings if no backend yet
  const DEFAULT_SETTINGS = {
    displayName: "Analyst",
    email: "analyst@example.com",
    role: "Administrator",
    themeMode: "light",
    refreshInterval: 30,
    notifyLevel: "all",
    enableLinuxLogs: true,
    enableWindowsLogs: true,
    enableSysmon: true,
    enableSuricata: false
  };

  const SETTINGS = (typeof MOCK_SETTINGS !== 'undefined') ? MOCK_SETTINGS : DEFAULT_SETTINGS;
function applyTheme(mode) {
  if (mode === 'dark') {
    document.documentElement.classList.add('dark-mode');
    document.body.classList.add('dark-mode');
  } else {
    document.documentElement.classList.remove('dark-mode');
    document.body.classList.remove('dark-mode');
  }
}

function loadSettings(){
  // load from SETTINGS (existing logic)
  document.getElementById('displayName').value = SETTINGS.displayName;
  document.getElementById('email').value = SETTINGS.email;
  document.getElementById('role').value = SETTINGS.role;
  document.getElementById('themeMode').value = SETTINGS.themeMode;
  document.getElementById('refreshInterval').value = SETTINGS.refreshInterval;
  document.getElementById('notifyLevel').value = SETTINGS.notifyLevel;
  document.getElementById('enableLinuxLogs').checked = SETTINGS.enableLinuxLogs;
  document.getElementById('enableWindowsLogs').checked = SETTINGS.enableWindowsLogs;
  document.getElementById('enableSysmon').checked = SETTINGS.enableSysmon;
  document.getElementById('enableSuricata').checked = SETTINGS.enableSuricata;

  // Apply live
  applyTheme(SETTINGS.themeMode);

  // Also ensure localStorage contains the theme for other pages
  try { localStorage.setItem('cyber_theme', SETTINGS.themeMode); } catch(e){}
}

function saveSettings(){
  const updated = {
    displayName: document.getElementById('displayName').value,
    email: document.getElementById('email').value,
    role: document.getElementById('role').value,
    themeMode: document.getElementById('themeMode').value,
    refreshInterval: parseInt(document.getElementById('refreshInterval').value),
    notifyLevel: document.getElementById('notifyLevel').value,
    enableLinuxLogs: document.getElementById('enableLinuxLogs').checked,
    enableWindowsLogs: document.getElementById('enableWindowsLogs').checked,
    enableSysmon: document.getElementById('enableSysmon').checked,
    enableSuricata: document.getElementById('enableSuricata').checked
  };

  // Persist locally (so reloads keep the theme)
  try {
    localStorage.setItem('cyber_settings', JSON.stringify(updated));
    localStorage.setItem('cyber_theme', updated.themeMode);
  } catch(e) {
    console.warn('Could not save settings to localStorage', e);
  }

  // Apply immediately
  applyTheme(updated.themeMode);

  alert("Settings saved (locally). Backend API will be connected later.");
}

// If there's previously saved settings in localStorage, prefer them
document.addEventListener('DOMContentLoaded', () => {
  try {
    const stored = JSON.parse(localStorage.getItem('cyber_settings') || 'null');
    if (stored) {
      Object.assign(SETTINGS, stored);
    }
  } catch(e){}

  loadSettings();
  document.getElementById('saveSettings').addEventListener('click', saveSettings);

  // Also allow live preview when selecting theme without saving
  document.getElementById('themeMode').addEventListener('change', (e)=>{
    applyTheme(e.target.value);
  });
});
</script>
 <script src="js/theme-loader.js"></script>
 <script src="js/toggle.js"></script>
</body>
</html>
